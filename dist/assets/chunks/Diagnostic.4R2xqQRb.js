import{j as e}from"../vendor/vendor-query.CYtcMPNU.js";import{u as s,a as t}from"../vendor/vendor-react.C0-ekqbG.js";import{k as a,u as r,M as n,n as i,W as c,a as o,A as l,b as d,c as m,d as x,g as u,e as h,o as g,T as p,p as j,L as w,I as N,q as b,Z as y,f}from"../entry/index.BTJ1QXK9.js";import{d as v}from"./diagnosticApiService.Fv9Zi4bb.js";import{P as _}from"./printer.DvBwtgcx.js";import{F as k}from"./file-text.LuSAC_HD.js";import{U as M}from"./user.DpJFzjjo.js";import"../vendor/vendor-supabase.CnuDrxPg.js";import"../vendor/vendor-utils.Cp7Vw4Xn.js";const S=a("battery",[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]]),C=a("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),E=a("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),U=a("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);class D{static instance;static getInstance(){return D.instance||(D.instance=new D),D.instance}async getSystemInfo(){const e=window.navigator,s=window.screen,t=e.userAgent;let a="Unknown",r="Unknown";if(t.includes("Windows NT")){a="Windows";const e=t.match(/Windows NT ([\d.]+)/);r=e?this.getWindowsVersion(e[1]):"Unknown"}else if(t.includes("Mac OS X")){a="macOS";const e=t.match(/Mac OS X ([\d_]+)/);r=e?e[1].replace(/_/g,"."):"Unknown"}else if(t.includes("Linux"))a="Linux",r="Unknown";else if(t.includes("Android")){a="Android";const e=t.match(/Android ([\d.]+)/);r=e?e[1]:"Unknown"}else if(t.includes("iPhone")||t.includes("iPad")){a="iOS";const e=t.match(/OS ([\d_]+)/);r=e?e[1].replace(/_/g,"."):"Unknown"}const n=e.deviceMemory,i=n?`${n} GB`:"Unknown";return{os:a,os_version:r,processor:`${e.hardwareConcurrency||1} cores detected`,ram:i,storage:"Unknown",screen_resolution:`${s.width}x${s.height}`,user_agent:t}}async getHardwareMetrics(){const e=window.navigator,s=window.performance,t=e.hardwareConcurrency||1,a=await this.estimateCPUUsage(),r=s.memory;return{cpu:{cores:t,threads:2*t,usage_percentage:a,temperature:null},memory:this.calculateMemoryMetrics(r),disk:await this.getStorageMetrics(),network:await this.getNetworkMetrics(),graphics:this.getGraphicsMetrics(),battery:await this.getBatteryMetrics()}}async estimateCPUUsage(){return new Promise((e=>{const s=performance.now(),t=performance.now()-s,a=Math.min(100,Math.max(5,t/10*20));e(Math.round(a))}))}calculateMemoryMetrics(e){if(e){const s=e.jsHeapSizeLimit/1073741824,t=e.usedJSHeapSize/1073741824,a=s-t,r=t/s*100;return{total_gb:Number(s.toFixed(2)),available_gb:Number(a.toFixed(2)),usage_percentage:Number(r.toFixed(1)),type:"JavaScript Heap"}}return{total_gb:8,available_gb:4,usage_percentage:50,type:"Estimated"}}async getStorageMetrics(){try{if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),s=e.quota||0,t=e.usage||0,a=s/1073741824,r=t/1073741824,n=a-r,i=a>0?r/a*100:0;return{total_gb:Number(a.toFixed(2)),available_gb:Number(n.toFixed(2)),usage_percentage:Number(i.toFixed(1)),type:"Browser Storage",read_speed:null,write_speed:null}}}catch(e){}return{total_gb:500,available_gb:250,usage_percentage:50,type:"Estimated SSD",read_speed:null,write_speed:null}}async getNetworkMetrics(){const e=navigator.connection;let s="Unknown";return e&&(s=e.effectiveType||e.type||"Unknown"),{connection_type:s,download_speed:e?.downlink||null,upload_speed:null,latency:e?.rtt||null,ip_address:null}}getGraphicsMetrics(){try{const e=document.createElement("canvas"),s=e.getContext("webgl")||e.getContext("experimental-webgl");if(s){const e=s.getExtension("WEBGL_debug_renderer_info"),t=e?s.getParameter(e.UNMASKED_RENDERER_WEBGL):"Unknown";return{renderer:t||"WebGL Renderer",vendor:(e?s.getParameter(e.UNMASKED_VENDOR_WEBGL):"Unknown")||"Unknown Vendor",memory_mb:null}}}catch(e){}return{renderer:"Unknown",vendor:"Unknown",memory_mb:null}}async getBatteryMetrics(){try{const e=await(navigator.getBattery?.());if(e)return{level:Math.round(100*e.level),charging:e.charging,estimated_time:e.dischargingTime===1/0?null:e.dischargingTime}}catch(e){}return{level:null,charging:null,estimated_time:null}}getWindowsVersion(e){return{"10.0":"Windows 10/11",6.3:"Windows 8.1",6.2:"Windows 8",6.1:"Windows 7","6.0":"Windows Vista",5.1:"Windows XP","5.0":"Windows 2000"}[e]||`Windows NT ${e}`}async runFullDiagnostic(e="Meu Computador"){try{const s=await this.getSystemInfo(),t=await this.getHardwareMetrics();return{device_name:e,system_info:s,hardware_metrics:t,timestamp:(new Date).toISOString(),diagnostic_type:"Real Hardware Scan"}}catch(s){throw s}}}const T=D.getInstance();function P(){const{user:a,company:D}=r(),P=s(),[A,R]=t.useState(""),[W,q]=t.useState(""),[L,I]=t.useState(""),[F,O]=t.useState(!1),[z,B]=t.useState(0),[V,G]=t.useState(null),[H,$]=t.useState(""),[J,X]=t.useState(null),[K,Z]=t.useState([{id:"system",name:"Sistema Operacional",description:"Verificando informações básicas do Windows/macOS",icon:e.jsx(n,{className:"h-5 w-5"}),status:"pending"},{id:"cpu",name:"Processador",description:"Testando performance e temperatura da CPU",icon:e.jsx(i,{className:"h-5 w-5"}),status:"pending"},{id:"memory",name:"Memória RAM",description:"Analisando uso e velocidade da memória",icon:e.jsx(C,{className:"h-5 w-5"}),status:"pending"},{id:"network",name:"Internet",description:"Testando velocidade e estabilidade da conexão",icon:e.jsx(c,{className:"h-5 w-5"}),status:"pending"},{id:"battery",name:"Bateria (Notebooks)",description:"Verificando saúde e capacidade da bateria",icon:e.jsx(S,{className:"h-5 w-5"}),status:"pending"}]),Q=(e,s,t)=>{Z((a=>a.map((a=>a.id===e?{...a,status:s,result:t,duration:"completed"===s?2:void 0}:a))))},Y=e=>{let s=100;return e.cpu.usage_percentage>80&&(s-=20),e.memory.usage_percentage>85&&(s-=25),e.disk.usage_percentage>90&&(s-=30),"Unknown"===e.network.connection_type&&(s-=15),Math.max(0,s)},ee=e=>new Promise((s=>setTimeout(s,e))),se=s=>{switch(s){case"running":return e.jsx(b,{className:"h-4 w-4 animate-spin text-electric"});case"completed":return e.jsx(f,{className:"h-4 w-4 text-green-400"});case"error":return e.jsx(p,{className:"h-4 w-4 text-red-400"});default:return null}},te=()=>{G(null),R(""),q(""),I(""),$(""),B(0),Z((e=>e.map((e=>({...e,status:"pending"})))))},ae=()=>{window.print()};if(V){const s=V.health_score||0,t=(e=>e>=80?{text:"EXCELENTE",color:"text-green-400",bgColor:"bg-green-400/20"}:e>=60?{text:"BOM",color:"text-yellow-400",bgColor:"bg-yellow-400/20"}:e>=40?{text:"REGULAR",color:"text-orange-400",bgColor:"bg-orange-400/20"}:{text:"CRÍTICO",color:"text-red-400",bgColor:"bg-red-400/20"})(s);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-tech-darker to-tech-dark print:bg-white",children:e.jsxs("div",{className:"container-responsive py-8 print:py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 print:hidden",children:[e.jsxs(o,{variant:"outline",onClick:()=>P("/dashboard"),className:"electric-border",children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(o,{variant:"outline",onClick:te,className:"electric-border",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Novo Diagnóstico"]}),e.jsxs(o,{onClick:ae,className:"btn-electric",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Imprimir Relatório"]})]})]}),e.jsx(d,{className:"card-electric mb-6",children:e.jsx(m,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-2xl tech-font mb-2",children:"🔧 RELATÓRIO DE DIAGNÓSTICO"}),e.jsxs(u,{className:"text-base",children:[e.jsx("strong",{children:"Cliente:"})," ",W," ",L&&`- ${L}`,e.jsx("br",{}),e.jsx("strong",{children:"Equipamento:"})," ",A,e.jsx("br",{}),e.jsx("strong",{children:"Data:"})," ",(new Date).toLocaleDateString("pt-BR")," às ",(new Date).toLocaleTimeString("pt-BR"),e.jsx("br",{}),e.jsx("strong",{children:"Técnico:"})," ",a?.email," (",D?.name,")"]})]}),e.jsx("div",{className:`px-4 py-2 rounded-lg ${t.bgColor} border`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold ${t.color}`,children:[s,"%"]}),e.jsx("div",{className:`text-sm font-medium ${t.color}`,children:t.text})]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs(d,{className:"card-electric",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center text-lg",children:[e.jsx(i,{className:"h-5 w-5 mr-2 text-electric"}),"Processador"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Uso atual:"}),e.jsxs("span",{className:V.cpu_metrics?.usage_percentage>80?"text-red-400":"text-green-400",children:[V.cpu_metrics?.usage_percentage||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:"normal"===V.cpu_status?"text-green-400":"text-yellow-400",children:"normal"===V.cpu_status?"Normal":"Atenção"})]})]})})]}),e.jsxs(d,{className:"card-electric",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center text-lg",children:[e.jsx(C,{className:"h-5 w-5 mr-2 text-electric"}),"Memória RAM"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Uso atual:"}),e.jsxs("span",{className:V.memory_metrics?.usage_percentage>85?"text-red-400":"text-green-400",children:[V.memory_metrics?.usage_percentage||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:"normal"===V.memory_status?"text-green-400":"text-yellow-400",children:"normal"===V.memory_status?"Normal":"Atenção"})]})]})})]}),e.jsxs(d,{className:"card-electric",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center text-lg",children:[e.jsx(c,{className:"h-5 w-5 mr-2 text-electric"}),"Conectividade"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Conexão:"}),e.jsx("span",{className:"text-green-400",children:V.network_metrics?.connection_type||"Ethernet"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:"normal"===V.network_status?"text-green-400":"text-yellow-400",children:"normal"===V.network_status?"Normal":"Verificar"})]})]})})]})]}),e.jsxs(d,{className:"card-electric",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(k,{className:"h-5 w-5 mr-2 text-electric"}),"Recomendações do Técnico"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-3",children:[s<60&&e.jsxs(g,{children:[e.jsx(p,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"⚠️ Atenção necessária:"})," O equipamento apresenta problemas que podem afetar o desempenho."]})]}),e.jsxs("div",{className:"bg-muted/10 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"📋 Checklist de Manutenção:"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsx("li",{children:"✅ Limpeza interna e externa realizada"}),e.jsx("li",{children:"✅ Teste de hardware completo executado"}),e.jsx("li",{children:"✅ Verificação de drivers e atualizações"}),e.jsx("li",{children:"✅ Teste de estresse dos componentes"})]})]}),s>=80?e.jsxs("div",{className:"bg-green-400/10 p-4 rounded-lg border border-green-400/20",children:[e.jsx("p",{className:"text-green-400 font-medium",children:"✅ Equipamento em excelente estado!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mantenha as atualizações em dia e realize limpeza periódica."})]}):s>=60?e.jsxs("div",{className:"bg-yellow-400/10 p-4 rounded-lg border border-yellow-400/20",children:[e.jsx("p",{className:"text-yellow-400 font-medium",children:"⚠️ Equipamento precisa de atenção"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recomendamos limpeza e otimização do sistema."})]}):e.jsxs("div",{className:"bg-red-400/10 p-4 rounded-lg border border-red-400/20",children:[e.jsx("p",{className:"text-red-400 font-medium",children:"🚨 Equipamento precisa de reparo"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Problemas identificados que requerem intervenção técnica."})]})]})})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-muted-foreground print:block",children:[e.jsx("p",{children:"Relatório gerado automaticamente pelo Sistema TechZe Diagnóstico"}),e.jsx("p",{children:"Para suporte técnico, entre em contato conosco"})]})]})})}return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-tech-darker to-tech-dark",children:e.jsxs("div",{className:"container-responsive py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs(o,{variant:"outline",onClick:()=>P("/dashboard"),className:"electric-border",children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsx("h1",{className:"text-2xl font-bold tech-font neon-text",children:"🔧 Diagnóstico Técnico"}),e.jsxs("div",{className:"text-sm text-muted-foreground text-right",children:[e.jsx("p",{children:e.jsx("strong",{children:D?.name})}),e.jsxs("p",{children:["Técnico: ",a?.email?.split("@")[0]]})]})]}),H&&e.jsxs(g,{className:"mb-6 bg-red-900/20 border-red-900/50",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(j,{children:H})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsxs(d,{className:"card-electric",children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 mr-2 text-electric"}),"Dados do Cliente e Equipamento"]}),e.jsx(u,{children:"Preencha as informações antes de iniciar o diagnóstico"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"clientName",className:"text-sm font-medium",children:"Nome do Cliente *"}),e.jsx(N,{id:"clientName",placeholder:"Ex: João Silva",value:W,onChange:e=>q(e.target.value),className:"electric-border",disabled:F})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"clientPhone",className:"text-sm font-medium",children:"Telefone (opcional)"}),e.jsx(N,{id:"clientPhone",placeholder:"Ex: (11) 99999-9999",value:L,onChange:e=>I(e.target.value),className:"electric-border",disabled:F})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"deviceName",className:"text-sm font-medium",children:"Modelo/Marca do Equipamento *"}),e.jsx(N,{id:"deviceName",placeholder:"Ex: Dell Inspiron 15 3000, MacBook Pro M1",value:A,onChange:e=>R(e.target.value),className:"electric-border",disabled:F})]}),e.jsx(o,{onClick:async()=>{if(A.trim())if(W.trim()){O(!0),$(""),B(0),X(new Date);try{Z((e=>e.map((e=>({...e,status:"pending"}))))),B(1),Q("system","running");const e=await T.getSystemInfo();Q("system","completed",e),await ee(1500),B(2),Q("cpu","running");const s=await T.getHardwareMetrics();Q("cpu","completed",s.cpu),await ee(1500),B(3),Q("memory","running"),Q("memory","completed",s.memory),await ee(1500),B(4),Q("network","running"),Q("network","completed",s.network),await ee(1500),B(5),Q("battery","running"),Q("battery","completed",s.battery),await ee(1500);const t=await T.runFullDiagnostic(A),a=await v.createDevice({name:A,type:"Desktop/Laptop",os:e.os,os_version:e.os_version,processor:e.processor,ram:e.ram,storage:e.storage||"Unknown"}),r=await v.saveDiagnostic({device_id:a.id,status:"completed",cpu_status:s.cpu.usage_percentage<80?"normal":"warning",cpu_metrics:s.cpu,memory_status:s.memory.usage_percentage<85?"normal":"warning",memory_metrics:s.memory,disk_status:s.disk.usage_percentage<90?"normal":"warning",disk_metrics:s.disk,network_status:"Unknown"!==s.network.connection_type?"normal":"warning",network_metrics:s.network,health_score:Y(s),raw_data:t,client_name:W,client_phone:L});G(r),B(0)}catch(e){$("Erro durante o diagnóstico. Verifique a conexão e tente novamente."),Q(K[z-1]?.id,"error")}finally{O(!1)}}else $("Por favor, informe o nome do cliente");else $("Por favor, informe o nome/modelo do dispositivo")},disabled:F||!A.trim()||!W.trim(),className:"w-full btn-electric tech-font font-semibold",size:"lg",children:F?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"mr-2 h-5 w-5 animate-spin"}),"Executando Diagnóstico..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-5 w-5"}),"Iniciar Diagnóstico Completo"]})})]})]}),e.jsxs(d,{className:"card-electric",children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(y,{className:"h-5 w-5 mr-2 text-electric"}),"Progresso do Diagnóstico"]}),e.jsx(u,{children:F?"Analisando o equipamento...":"Aguardando início do teste"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"space-y-4",children:K.map(((s,t)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg border transition-all "+("running"===s.status?"bg-electric/10 border-electric/30 electric-glow":"completed"===s.status?"bg-green-400/10 border-green-400/30":"error"===s.status?"bg-red-400/10 border-red-400/30":"bg-muted/5 border-muted/10"),children:[e.jsx("div",{className:"flex-shrink-0",children:"pending"===s.status?e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted/20",children:s.icon}):e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full",children:se(s.status)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.name}),s.duration&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.duration,"s"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]})]},s.id)))}),F&&J&&e.jsx("div",{className:"mt-4 pt-4 border-t border-muted/20",children:e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Tempo decorrido:"}),e.jsxs("span",{children:[Math.floor((Date.now()-J.getTime())/1e3),"s"]})]})})]})]})]})]})})}export{P as default};
