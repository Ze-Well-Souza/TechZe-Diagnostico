import{j as e}from"../vendor/vendor-query.CYtcMPNU.js";import{a}from"../vendor/vendor-react.C0-ekqbG.js";import{k as s,u as i,h as o,a as t,D as r,b as l,c as n,d as c,e as d,L as m,C as u,U as x,r as p}from"../entry/index.BTJ1QXK9.js";import{u as j,D as h,c as v,C as g}from"./DateRangePicker.CiJ9ZgRF.js";import{M as f}from"./MainLayout.qzj9ucUQ.js";import{B as b}from"./badge.BCKbA_Tg.js";import{T as N,a as y,b as C,c as q}from"./tabs.BJawdkgg.js";import{S as R,a as w,b as k,c as M,d as S}from"./select.D75MbHUz.js";import{s as D,h as P}from"../vendor/vendor-utils.Cp7Vw4Xn.js";import{F as T}from"./file-text.LuSAC_HD.js";import{D as E}from"./dollar-sign.BDvHB1j_.js";import{P as A}from"./package.fhd-M5KA.js";import{T as L}from"./trending-up.B7GeU7Km.js";import{P as O}from"./printer.DvBwtgcx.js";import{C as F}from"./calendar.C3WoCpfa.js";import{M as V}from"./mail.O52PZRan.js";import{S as B}from"./settings.BLeElVKi.js";import"../vendor/vendor-supabase.CnuDrxPg.js";import"./star.BtdBosQj.js";import"./trending-down.BtsJ1fhi.js";import"./chevron-right.DN28NIWR.js";import"./index.D5-XNnO7.js";import"../vendor/vendor-ui.TbV-WW-S.js";import"./log-out.BkHA6lQO.js";import"./search.x8-RwjLr.js";const z=s("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),I=s("share",[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]]),G=s("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),J=s("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),U=[{value:"todos",label:"Todos os Relatórios",icon:u},{value:"financeiro",label:"Financeiro",icon:E},{value:"operacional",label:"Operacional",icon:J},{value:"clientes",label:"Clientes",icon:x},{value:"estoque",label:"Estoque",icon:A}],$=[{value:"pdf",label:"PDF",icon:T},{value:"excel",label:"Excel",icon:T},{value:"csv",label:"CSV",icon:T}],H=[{value:"7d",label:"Últimos 7 dias",dias:7},{value:"30d",label:"Últimos 30 dias",dias:30},{value:"90d",label:"Últimos 90 dias",dias:90},{value:"1y",label:"Último ano",dias:365}];function Q(){const{user:s,company:T}=i(),{addNotification:Q}=o(),[W,K]=a.useState("dashboard"),[X,Y]=a.useState(!1),[Z,_]=a.useState({periodo:{inicio:D(new Date,30),fim:new Date},tipo:"todos"}),[ee,ae]=a.useState({financeiro:{receita:45680.5,lucro:13704.15,ticketMedio:285.4,receitaPorDia:[],receitaPorCategoria:[{categoria:"Reparos",valor:28500},{categoria:"Peças",valor:12300},{categoria:"Consultoria",valor:4880}]},operacional:{osAbertas:23,osConcluidas:156,tempoMedioReparo:2.5,satisfacaoCliente:4.7,produtividadeTecnicos:[{tecnico:"João Silva",os:45,tempo:2.2},{tecnico:"Maria Santos",os:38,tempo:2.8},{tecnico:"Pedro Costa",os:42,tempo:2.4}],statusOS:[{status:"Aguardando Peças",quantidade:8},{status:"Em Reparo",quantidade:12},{status:"Aguardando Cliente",quantidade:3}]},clientes:{novosClientes:34,clientesRecorrentes:89,taxaRetencao:72.5,nps:8.4,clientesPorRegiao:[{regiao:"Centro",quantidade:45},{regiao:"Norte",quantidade:32},{regiao:"Sul",quantidade:28},{regiao:"Leste",quantidade:18}],avaliacoes:[{nota:5,quantidade:89},{nota:4,quantidade:34},{nota:3,quantidade:12},{nota:2,quantidade:3},{nota:1,quantidade:1}]},estoque:{valorTotal:89450.3,itensEmFalta:7,giroEstoque:4.2,margemLucro:32.5,itensMaisVendidos:[{item:"Memória RAM 8GB",quantidade:45,valor:6750},{item:"SSD 240GB",quantidade:38,valor:5700},{item:"Fonte 500W",quantidade:32,valor:3200}],movimentacoes:[]}});j({dateRange:Z.periodo,autoRefresh:!1}),a.useEffect((()=>{se()}),[Z]);const se=async()=>{Y(!0);try{await new Promise((e=>setTimeout(e,1e3)));const e=[],a=Math.ceil((Z.periodo.fim.getTime()-Z.periodo.inicio.getTime())/864e5);for(let i=0;i<a;i++){const a=new Date(Z.periodo.inicio);a.setDate(a.getDate()+i),e.push({data:P(a,"dd/MM"),valor:2e3*Math.random()+500})}const s=[];for(let i=0;i<a;i++){const e=new Date(Z.periodo.inicio);e.setDate(e.getDate()+i),s.push({data:P(e,"dd/MM"),entrada:Math.floor(20*Math.random()),saida:Math.floor(15*Math.random())})}ae((a=>({...a,financeiro:{...a.financeiro,receitaPorDia:e},estoque:{...a.estoque,movimentacoes:s}})))}catch(e){Q({type:"error",title:"Erro ao carregar dados",message:"Não foi possível carregar os dados do relatório."})}finally{Y(!1)}},ie=e=>{Q({type:"info",title:"Exportação iniciada",message:`O relatório será gerado em formato ${e.toUpperCase()} e enviado por email.`})};return e.jsx(f,{children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Relatórios"}),e.jsx("p",{className:"text-muted-foreground",children:"Análises detalhadas e insights do seu negócio"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"outline",onClick:()=>{Q({type:"info",title:"Link gerado",message:"Link de compartilhamento copiado para a área de transferência."})},children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Compartilhar"]}),e.jsxs(R,{onValueChange:ie,children:[e.jsxs(w,{className:"w-32",children:[e.jsx(r,{className:"h-4 w-4 mr-2"}),e.jsx(k,{placeholder:"Exportar"})]}),e.jsx(M,{children:$.map((a=>e.jsx(S,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a.icon,{className:"h-4 w-4"}),a.label]})},a.value)))})]})]})]}),e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Filtros"]})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Período"}),e.jsx("div",{className:"flex gap-2",children:H.map((a=>e.jsx(t,{variant:"outline",size:"sm",onClick:()=>(e=>{const a=H.find((a=>a.value===e));a&&_({...Z,periodo:{inicio:D(new Date,a.dias),fim:new Date}})})(a.value),className:"text-xs",children:a.label},a.value)))}),e.jsx(h,{value:Z.periodo,onChange:e=>_({...Z,periodo:e})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Tipo de Relatório"}),e.jsxs(R,{value:Z.tipo,onValueChange:e=>_({...Z,tipo:e}),children:[e.jsx(w,{children:e.jsx(k,{})}),e.jsx(M,{children:U.map((a=>e.jsx(S,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a.icon,{className:"h-4 w-4"}),a.label]})},a.value)))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Loja"}),e.jsxs(R,{value:Z.loja,onValueChange:e=>_({...Z,loja:e}),children:[e.jsx(w,{children:e.jsx(k,{placeholder:"Todas as lojas"})}),e.jsxs(M,{children:[e.jsx(S,{value:"centro",children:"Loja Centro"}),e.jsx(S,{value:"norte",children:"Loja Norte"}),e.jsx(S,{value:"sul",children:"Loja Sul"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(t,{onClick:()=>{se(),Q({type:"success",title:"Filtros aplicados",message:"Os relatórios foram atualizados com os novos filtros."})},disabled:X,children:X?"Carregando...":"Aplicar Filtros"})})]})})]}),e.jsxs(N,{value:W,onValueChange:K,className:"space-y-6",children:[e.jsxs(y,{className:"grid w-full grid-cols-5",children:[e.jsxs(C,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Dashboard"]}),e.jsxs(C,{value:"financeiro",className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Financeiro"]}),e.jsxs(C,{value:"operacional",className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Operacional"]}),e.jsxs(C,{value:"clientes",className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Clientes"]}),e.jsxs(C,{value:"estoque",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Estoque"]})]}),e.jsxs(q,{value:"dashboard",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(v,{title:"Receita Total",value:ee.financeiro.receita,format:"currency",trend:12.5,icon:E,description:"Últimos 30 dias"}),e.jsx(v,{title:"OS Concluídas",value:ee.operacional.osConcluidas,format:"number",trend:8.2,icon:J,description:"Últimos 30 dias"}),e.jsx(v,{title:"Novos Clientes",value:ee.clientes.novosClientes,format:"number",trend:15.3,icon:x,description:"Últimos 30 dias"}),e.jsx(v,{title:"Valor Estoque",value:ee.estoque.valorTotal,format:"currency",trend:-2.1,icon:A,description:"Valor atual"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(g,{title:"Receita por Dia",type:"line",data:{labels:ee.financeiro.receitaPorDia.map((e=>e.data)),datasets:[{label:"Receita",data:ee.financeiro.receitaPorDia.map((e=>e.valor)),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]}}),e.jsx(g,{title:"Status das OS",type:"doughnut",data:{labels:ee.operacional.statusOS.map((e=>e.status)),datasets:[{data:ee.operacional.statusOS.map((e=>e.quantidade)),backgroundColor:["#3b82f6","#10b981","#f59e0b","#ef4444"]}]}})]})]}),e.jsxs(q,{value:"financeiro",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(v,{title:"Receita Total",value:ee.financeiro.receita,format:"currency",trend:12.5,icon:E}),e.jsx(v,{title:"Lucro Líquido",value:ee.financeiro.lucro,format:"currency",trend:18.3,icon:L}),e.jsx(v,{title:"Ticket Médio",value:ee.financeiro.ticketMedio,format:"currency",trend:5.7,icon:G})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(g,{title:"Receita por Dia",type:"line",data:{labels:ee.financeiro.receitaPorDia.map((e=>e.data)),datasets:[{label:"Receita",data:ee.financeiro.receitaPorDia.map((e=>e.valor)),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4}]}}),e.jsx(g,{title:"Receita por Categoria",type:"pie",data:{labels:ee.financeiro.receitaPorCategoria.map((e=>e.categoria)),datasets:[{data:ee.financeiro.receitaPorCategoria.map((e=>e.valor)),backgroundColor:["#3b82f6","#10b981","#f59e0b"]}]}})]}),e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(c,{children:"Detalhamento Financeiro"})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:ee.financeiro.receitaPorCategoria.map(((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.categoria}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(a.valor/ee.financeiro.receita*100).toFixed(1),"% da receita total"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-bold text-lg",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.valor)})})]},s)))})})]})]}),e.jsxs(q,{value:"operacional",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(v,{title:"OS Abertas",value:ee.operacional.osAbertas,format:"number",trend:-5.2,icon:p}),e.jsx(v,{title:"OS Concluídas",value:ee.operacional.osConcluidas,format:"number",trend:8.2,icon:J}),e.jsx(v,{title:"Tempo Médio",value:ee.operacional.tempoMedioReparo,format:"decimal",suffix:" dias",trend:-12.1,icon:p}),e.jsx(v,{title:"Satisfação",value:ee.operacional.satisfacaoCliente,format:"decimal",suffix:"/5",trend:3.4,icon:G})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(c,{children:"Produtividade dos Técnicos"})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:ee.operacional.produtividadeTecnicos.map(((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.tecnico}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tempo médio: ",a.tempo," dias"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-lg",children:[a.os," OS"]}),e.jsx(b,{variant:a.os>40?"default":"secondary",children:a.os>40?"Alto":"Médio"})]})]},s)))})})]}),e.jsx(g,{title:"Status das Ordens de Serviço",type:"bar",data:{labels:ee.operacional.statusOS.map((e=>e.status)),datasets:[{label:"Quantidade",data:ee.operacional.statusOS.map((e=>e.quantidade)),backgroundColor:"#3b82f6"}]}})]})]}),e.jsxs(q,{value:"clientes",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(v,{title:"Novos Clientes",value:ee.clientes.novosClientes,format:"number",trend:15.3,icon:x}),e.jsx(v,{title:"Recorrentes",value:ee.clientes.clientesRecorrentes,format:"number",trend:8.7,icon:x}),e.jsx(v,{title:"Taxa Retenção",value:ee.clientes.taxaRetencao,format:"percentage",trend:2.1,icon:G}),e.jsx(v,{title:"NPS",value:ee.clientes.nps,format:"decimal",suffix:"/10",trend:5.2,icon:L})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(g,{title:"Clientes por Região",type:"bar",data:{labels:ee.clientes.clientesPorRegiao.map((e=>e.regiao)),datasets:[{label:"Clientes",data:ee.clientes.clientesPorRegiao.map((e=>e.quantidade)),backgroundColor:"#10b981"}]}}),e.jsx(g,{title:"Distribuição de Avaliações",type:"bar",data:{labels:ee.clientes.avaliacoes.map((e=>`${e.nota} estrelas`)),datasets:[{label:"Avaliações",data:ee.clientes.avaliacoes.map((e=>e.quantidade)),backgroundColor:["#ef4444","#f59e0b","#eab308","#22c55e","#10b981"]}]}})]})]}),e.jsxs(q,{value:"estoque",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(v,{title:"Valor Total",value:ee.estoque.valorTotal,format:"currency",trend:-2.1,icon:A}),e.jsx(v,{title:"Itens em Falta",value:ee.estoque.itensEmFalta,format:"number",trend:-15.3,icon:A}),e.jsx(v,{title:"Giro do Estoque",value:ee.estoque.giroEstoque,format:"decimal",suffix:"x",trend:8.2,icon:L}),e.jsx(v,{title:"Margem Lucro",value:ee.estoque.margemLucro,format:"percentage",trend:3.1,icon:E})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(c,{children:"Itens Mais Vendidos"})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:ee.estoque.itensMaisVendidos.map(((a,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.item}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.quantidade," unidades vendidas"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-bold text-lg",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.valor)})})]},s)))})})]}),e.jsx(g,{title:"Movimentação de Estoque",type:"line",data:{labels:ee.estoque.movimentacoes.map((e=>e.data)),datasets:[{label:"Entrada",data:ee.estoque.movimentacoes.map((e=>e.entrada)),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4},{label:"Saída",data:ee.estoque.movimentacoes.map((e=>e.saida)),borderColor:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4}]}})]})]})]}),e.jsxs(l,{children:[e.jsx(n,{children:e.jsx(c,{children:"Ações Rápidas"})}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs(t,{variant:"outline",onClick:()=>ie("pdf"),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Imprimir Relatório"]}),e.jsxs(t,{variant:"outline",onClick:()=>{Q({type:"success",title:"Relatório agendado",message:"O relatório será enviado automaticamente conforme configurado."})},children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Agendar Envio"]}),e.jsxs(t,{variant:"outline",onClick:()=>ie("email"),children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Enviar por Email"]}),e.jsxs(t,{variant:"outline",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Configurar Relatório"]})]})})]})]})})}export{Q as default};
