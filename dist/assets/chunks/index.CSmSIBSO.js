import{j as e}from"../vendor/vendor-query.CYtcMPNU.js";import{u as s,a,L as r}from"../vendor/vendor-react.C0-ekqbG.js";import{a as t,o,j as l,p as n,b as d,c as i,d as c,e as m,r as x,t as j,I as h,m as u,D as p}from"../entry/index.BTJ1QXK9.js";import{B as v}from"./badge.BCKbA_Tg.js";import{u as N}from"./useOrcamentos.CwFtpo99.js";import{P as f}from"./plus.BUsgb2rM.js";import{T as g}from"./trending-up.B7GeU7Km.js";import{D as b,C as w}from"./dollar-sign.BDvHB1j_.js";import{S as y}from"./search.x8-RwjLr.js";import{F as C}from"./file-text.LuSAC_HD.js";import{C as D}from"./calendar.C3WoCpfa.js";import{S as T}from"./square-pen.EayU8wcR.js";import{S as A}from"./send.Hwod_5Dq.js";import"../vendor/vendor-supabase.CnuDrxPg.js";import"../vendor/vendor-utils.Cp7Vw4Xn.js";const P=()=>{s();const{orcamentos:P,carregando:E,erro:L,estatisticas:S}=N(),[R,B]=a.useState(""),[O,z]=a.useState("todos"),F=P.filter((e=>{const s="todos"===O||e.status===O,a=!R||e.numero.toLowerCase().includes(R.toLowerCase())||e.cliente?.nome.toLowerCase().includes(R.toLowerCase());return s&&a})),I=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),V=e=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(e)),$={rascunho:{label:"Rascunho",color:"bg-gray-100 text-gray-800 border-gray-200",icon:e.jsx(T,{className:"w-3 h-3"})},pendente:{label:"Pendente",color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:e.jsx(x,{className:"w-3 h-3"})},aprovado:{label:"Aprovado",color:"bg-green-100 text-green-800 border-green-200",icon:e.jsx(j,{className:"w-3 h-3"})},rejeitado:{label:"Rejeitado",color:"bg-red-100 text-red-800 border-red-200",icon:e.jsx(w,{className:"w-3 h-3"})},expirado:{label:"Expirado",color:"bg-red-100 text-red-800 border-red-200",icon:e.jsx(w,{className:"w-3 h-3"})}};return E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Orçamentos"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie todos os orçamentos da sua empresa"})]}),e.jsx(r,{to:"/orcamentos/novo",children:e.jsxs(t,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Novo Orçamento"]})})]}),L&&e.jsxs(o,{variant:"destructive",children:[e.jsx(l,{className:"h-4 w-4"}),e.jsx(n,{children:L})]}),S&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total de Orçamentos"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Todos os orçamentos"})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Pendentes"}),e.jsx(x,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:S.pendentes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aguardando aprovação"})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Aprovados"}),e.jsx(j,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:S.aprovados}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Confirmados pelo cliente"})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Valor Aprovado"}),e.jsx(b,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:I(S.valorAprovado)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total em orçamentos aprovados"})]})]})]}),e.jsx(d,{className:"mb-6",children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(h,{placeholder:"Buscar por número do orçamento...",value:R,onChange:e=>B(e.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"sm:w-48",children:e.jsxs("select",{value:O,onChange:e=>z(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"todos",children:"Todos os status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"aprovado",children:"Aprovado"}),e.jsx("option",{value:"rejeitado",children:"Rejeitado"}),e.jsx("option",{value:"expirado",children:"Expirado"})]})})]})})}),e.jsx("div",{className:"space-y-4",children:0===F.length?e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum orçamento encontrado"}),e.jsx("p",{className:"text-gray-500 mb-4",children:R||"todos"!==O?"Tente ajustar os filtros de busca":"Comece criando seu primeiro orçamento"}),!R&&"todos"===O&&e.jsx(r,{to:"/orcamentos/novo",children:e.jsxs(t,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Criar Primeiro Orçamento"]})})]})})}):F.map((s=>{const a=$[s.status],o=(e=>{const s=new Date,a=new Date(e).getTime()-s.getTime(),r=Math.ceil(a/864e5);return r<=2&&r>0})(s.validadeAte),l=(e=>{const s=new Date;return new Date(e)<s})(s.validadeAte);return e.jsx(d,{className:"hover:shadow-md transition-shadow",children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.numero}),e.jsxs(v,{className:`${a.color} flex items-center gap-1`,children:[a.icon,a.label]}),o&&e.jsxs(v,{className:"bg-orange-100 text-orange-800 border-orange-200",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Expira em breve"]}),l&&e.jsxs(v,{className:"bg-red-100 text-red-800 border-red-200",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Expirado"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Valor Total:"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:I(s.valorTotal)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Criado em:"}),e.jsx("div",{children:V(s.criadoEm)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Válido até:"}),e.jsx("div",{className:l?"text-red-600 font-medium":o?"text-orange-600 font-medium":"",children:V(s.validadeAte)})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-medium text-sm text-gray-600",children:"Itens:"}),e.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:[s.itens.length," item(s) - Peças: ",I(s.valorPecas)," | Serviços: ",I(s.valorServicos),s.valorDesconto>0&&e.jsxs("span",{className:"text-green-600",children:[" | Desconto: ",I(s.valorDesconto)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 lg:mt-0",children:[e.jsx(r,{to:`/orcamentos/${s.id}`,children:e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Ver"]})}),"pendente"===s.status&&e.jsx(r,{to:`/orcamentos/${s.id}/editar`,children:e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(T,{className:"w-4 h-4 mr-1"}),"Editar"]})}),e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(p,{className:"w-4 h-4 mr-1"}),"PDF"]}),"pendente"===s.status&&e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Enviar"]})]})]})})},s.id)}))})]})};export{P as default};
