import{j as e}from"../vendor/vendor-query.CYtcMPNU.js";import{a as s,L as a}from"../vendor/vendor-react.C0-ekqbG.js";import{M as t,U as i,Z as r,T as l,h as o,i as c,b as n,e as d,j as m,a as x,R as h,D as j,C as p,u,A as g}from"../entry/index.BTJ1QXK9.js";import{G as v}from"./GlassCard.-HpAhMPg.js";import{T as f,a as N,b,c as w}from"./tabs.BJawdkgg.js";import{A as y}from"./activity.Bku7NG6a.js";import{T as A}from"./trending-up.B7GeU7Km.js";import{B as z}from"./badge.BCKbA_Tg.js";import{u as R,a as C,D,M as S,C as M,b as O}from"./DateRangePicker.CiJ9ZgRF.js";import{s as T}from"../vendor/vendor-utils.Cp7Vw4Xn.js";import{D as q}from"./dollar-sign.BDvHB1j_.js";import{S as k}from"./settings.BLeElVKi.js";import"./select.D75MbHUz.js";import{L as E}from"./log-out.BkHA6lQO.js";import"../vendor/vendor-supabase.CnuDrxPg.js";import"../vendor/vendor-ui.TbV-WW-S.js";import"./star.BtdBosQj.js";import"./trending-down.BtsJ1fhi.js";import"./chevron-right.DN28NIWR.js";import"./index.D5-XNnO7.js";import"./calendar.C3WoCpfa.js";const G=({title:s,value:a,icon:t,color:i,trend:r,suffix:l=""})=>e.jsx(v,{className:"p-6 hover:scale-105 transition-all duration-300",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${{blue:"text-blue-400 bg-blue-400/10 border-blue-400/20",green:"text-green-400 bg-green-400/10 border-green-400/20",purple:"text-purple-400 bg-purple-400/10 border-purple-400/20",red:"text-red-400 bg-red-400/10 border-red-400/20",yellow:"text-yellow-400 bg-yellow-400/10 border-yellow-400/20"}[i]} flex items-center justify-center mb-4`,children:t}),e.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-2",children:s}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:a.toLocaleString("pt-BR")}),l&&e.jsx("span",{className:"text-lg text-slate-400 mb-1",children:l})]}),void 0!==r&&e.jsxs("div",{className:"flex items-center mt-2 text-sm "+(r>=0?"text-green-400":"text-red-400"),children:[e.jsx(A,{className:"w-4 h-4 mr-1 "+(r<0?"rotate-180":"")}),e.jsxs("span",{children:[Math.abs(r),"% vs. ontem"]})]})]})})}),V=({data:s})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[e.jsx(G,{title:"Total de Dispositivos",value:s.dispositivos,icon:e.jsx(t,{className:"w-6 h-6"}),color:"blue",trend:12}),e.jsx(G,{title:"Usuários Ativos",value:s.usuarios,icon:e.jsx(i,{className:"w-6 h-6"}),color:"green",trend:8}),e.jsx(G,{title:"Saúde Média",value:s.saude,icon:e.jsx(r,{className:"w-6 h-6"}),color:"purple",suffix:"%",trend:5}),e.jsx(G,{title:"Diagnósticos Hoje",value:s.diagnosticos_hoje,icon:e.jsx(y,{className:"w-6 h-6"}),color:"yellow",trend:-3}),e.jsx(G,{title:"Alertas Críticos",value:s.alertas_criticos,icon:e.jsx(l,{className:"w-6 h-6"}),color:"red",trend:-15})]}),$={start:T(new Date,30),end:new Date},F=({className:a})=>{const[t,r]=s.useState($),[l,u]=s.useState("overview"),[g,v]=s.useState(!0),{addNotification:y}=o(),{metrics:A,charts:O,isLoading:T,error:E,refetch:G,updateDateRange:V}=R({dateRange:t,autoRefresh:g,refreshInterval:3e5}),F=C(A),L=()=>{G(),y({type:"success",title:"Dashboard atualizado",message:"Os dados foram atualizados com sucesso."})},_=(()=>{if(!A)return[];const e=[];return A.taxaAprovacao<50&&e.push({type:"error",title:"Taxa de aprovação baixa",message:`Taxa atual: ${A.taxaAprovacao.toFixed(1)}%`}),A.osAbertas>20&&e.push({type:"warning",title:"Muitas OS abertas",message:`${A.osAbertas} ordens de serviço pendentes`}),A.estoqueAlerta>10&&e.push({type:"warning",title:"Estoque baixo",message:`${A.estoqueAlerta} itens com estoque baixo`}),A.tempoMedioReparo>7&&e.push({type:"error",title:"Tempo de reparo alto",message:`Média atual: ${A.tempoMedioReparo.toFixed(1)} dias`}),e})();return E?e.jsx("div",{className:c("p-6",a),children:e.jsx(n,{className:"border-red-200 bg-red-50",children:e.jsxs(d,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(m,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Erro ao carregar dashboard"})]}),e.jsx("p",{className:"text-sm text-red-500 mt-2",children:E.message||"Ocorreu um erro inesperado"}),e.jsxs(x,{variant:"outline",size:"sm",onClick:L,className:"mt-4",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Tentar novamente"]})]})})}):e.jsxs("div",{className:c("space-y-6 p-6",a),children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Executivo"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Visão geral do desempenho da empresa"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx(D,{value:t,onChange:e=>{r(e),V(e),y({type:"info",title:"Período atualizado",message:"Os dados do dashboard foram atualizados para o novo período."})},disabled:T}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>{v(!g),y({type:"info",title:g?"Auto-atualização desativada":"Auto-atualização ativada",message:g?"Os dados não serão mais atualizados automaticamente.":"Os dados serão atualizados a cada 5 minutos."})},className:c(g&&"bg-green-50 border-green-200 text-green-700"),children:[e.jsx(h,{className:c("h-4 w-4 mr-2",g&&"text-green-600")}),"Auto-refresh"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:L,disabled:T,children:[e.jsx(h,{className:c("h-4 w-4 mr-2",T&&"animate-spin")}),"Atualizar"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>{y({type:"info",title:"Exportação iniciada",message:"O relatório será gerado e enviado por email."})},children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Exportar"]})]})]})]}),_.length>0&&e.jsx("div",{className:"space-y-2",children:_.map(((s,a)=>e.jsx(n,{className:c("border-l-4","error"===s.type&&"border-l-red-500 bg-red-50","warning"===s.type&&"border-l-yellow-500 bg-yellow-50"),children:e.jsx(d,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{className:c("h-4 w-4","error"===s.type&&"text-red-500","warning"===s.type&&"text-yellow-500")}),e.jsx("span",{className:"font-medium",children:s.title}),e.jsx(z,{variant:"secondary",children:s.message})]})})},a)))}),e.jsxs(f,{value:l,onValueChange:u,className:"space-y-6",children:[e.jsxs(N,{className:"grid w-full grid-cols-4",children:[e.jsxs(b,{value:"overview",className:"flex items-center space-x-2",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{children:"Visão Geral"})]}),e.jsxs(b,{value:"financial",className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:"Financeiro"})]}),e.jsxs(b,{value:"operations",className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Operações"})]}),e.jsxs(b,{value:"customers",className:"flex items-center space-x-2",children:[e.jsx(i,{className:"h-4 w-4"}),e.jsx("span",{children:"Clientes"})]})]}),e.jsxs(w,{value:"overview",className:"space-y-6",children:[e.jsx(S,{metrics:F,loading:T,columns:4}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(M,{config:O.faturamento,loading:T,onRefresh:L,height:350}),e.jsx(M,{config:O.orcamentos,loading:T,onRefresh:L,height:350})]})]}),e.jsxs(w,{value:"financial",className:"space-y-6",children:[e.jsx(S,{metrics:F.filter((e=>["Faturamento Mensal","Ticket Médio","Taxa de Aprovação"].includes(e.title))),loading:T,columns:3}),e.jsx(M,{config:O.faturamento,loading:T,onRefresh:L,height:400})]}),e.jsxs(w,{value:"operations",className:"space-y-6",children:[e.jsx(S,{metrics:F.filter((e=>["OS Abertas","Tempo Médio Reparo","Estoque em Alerta"].includes(e.title))),loading:T,columns:3}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(M,{config:O.ordemServico,loading:T,onRefresh:L,height:350}),e.jsx(M,{config:O.estoque,loading:T,onRefresh:L,height:350})]})]}),e.jsxs(w,{value:"customers",className:"space-y-6",children:[e.jsx(S,{metrics:F.filter((e=>["Satisfação Cliente"].includes(e.title))),loading:T,columns:1}),e.jsx(M,{config:O.satisfacao,loading:T,onRefresh:L,height:400})]})]})]})};function L(){const{user:r,company:l,signOut:o}=u(),[c,n]=s.useState({lojas:{centro:{dispositivos:45,usuarios:23,saude:89},norte:{dispositivos:32,usuarios:18,saude:91},sul:{dispositivos:28,usuarios:12,saude:87}},totais:{dispositivos:105,usuarios:53,saude:89,diagnosticos_hoje:131,alertas_criticos:3}});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:e.jsxs("div",{className:"p-6",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(a,{to:"/dashboard",children:e.jsxs(x,{variant:"outline",size:"sm",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Dashboard Global"})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:o,children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Sair"]})]})}),e.jsxs(f,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(N,{className:"grid w-full grid-cols-2 bg-slate-800/50 border border-slate-700",children:[e.jsxs(b,{value:"overview",className:"flex items-center space-x-2 data-[state=active]:bg-slate-700 data-[state=active]:text-white",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx("span",{children:"Visão Operacional"})]}),e.jsxs(b,{value:"executive",className:"flex items-center space-x-2 data-[state=active]:bg-slate-700 data-[state=active]:text-white",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:"Dashboard Executivo"})]})]}),e.jsxs(w,{value:"overview",className:"space-y-6",children:[e.jsx(V,{data:c.totais}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(a,{to:"/clientes",children:e.jsx(v,{className:"p-6 hover:scale-105 transition-all duration-300 cursor-pointer",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i,{className:"w-8 h-8 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Gestão de Clientes"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Gerenciar todos os clientes"})]})]})})}),e.jsx(a,{to:"/diagnostic",children:e.jsx(v,{className:"p-6 hover:scale-105 transition-all duration-300 cursor-pointer",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{className:"w-8 h-8 text-green-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Novo Diagnóstico"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Iniciar diagnóstico técnico"})]})]})})}),e.jsx(v,{className:"p-6 hover:scale-105 transition-all duration-300 cursor-pointer",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(p,{className:"w-8 h-8 text-purple-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Relatórios"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Análises e relatórios"})]})]})})]})]}),e.jsx(w,{value:"executive",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg",children:e.jsx(F,{})})})]})]})})}export{L as default};
